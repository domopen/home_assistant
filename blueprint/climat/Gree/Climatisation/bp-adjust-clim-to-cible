blueprint:
  name: Ajustement des Températures des Climatisations
  description: >-
    Ajuste la température des climatiseurs selon les valeurs des input_number pour le mode jour ou nuit.
  domain: automation
  input:
    mode_nuit:
      name: Mode Nuit
      description: Entité boolean pour activer le mode nuit
      selector:
        entity:
          domain: input_boolean
    temp_cible_salon:
      name: Température Cible Salon (Jour)
      description: Entité input_number pour la température cible du salon en mode jour
      selector:
        entity:
          domain: input_number
    temp_cible_bureau:
      name: Température Cible Bureau (Jour)
      description: Entité input_number pour la température cible du bureau en mode jour
      selector:
        entity:
          domain: input_number
    temp_cible_chambre:
      name: Température Cible Chambre (Jour)
      description: Entité input_number pour la température cible de la chambre en mode jour
      selector:
        entity:
          domain: input_number
    temp_cible_nuit_salon:
      name: Température Cible Salon (Nuit)
      description: Entité input_number pour la température cible du salon en mode nuit
      selector:
        entity:
          domain: input_number
    temp_cible_nuit_bureau:
      name: Température Cible Bureau (Nuit)
      description: Entité input_number pour la température cible du bureau en mode nuit
      selector:
        entity:
          domain: input_number
    temp_cible_nuit_chambre:
      name: Température Cible Chambre (Nuit)
      description: Entité input_number pour la température cible de la chambre en mode nuit
      selector:
        entity:
          domain: input_number
    clim_salon:
      name: Climatisation Salon
      description: Entité de climatisation du salon
      selector:
        entity:
          domain: climate
    clim_bureau:
      name: Climatisation Bureau
      description: Entité de climatisation du bureau
      selector:
        entity:
          domain: climate
    clim_chambre:
      name: Climatisation Chambre
      description: Entité de climatisation de la chambre
      selector:
        entity:
          domain: climate
trigger:
  - platform: state
    entity_id:
      - !input temp_cible_salon
      - !input temp_cible_bureau
      - !input temp_cible_chambre
      - !input temp_cible_nuit_salon
      - !input temp_cible_nuit_bureau
      - !input temp_cible_nuit_chambre
  - platform: time_pattern
    minutes: "/15"
condition: []
action:
  - choose:
      - conditions:
          - condition: state
            entity_id: !input mode_nuit
            state: "on"
        sequence:
          - service: climate.set_temperature
            target:
              entity_id: !input clim_salon
            data:
              temperature: "{{ states(!input temp_cible_nuit_salon) | float }}"
          - service: climate.set_temperature
            target:
              entity_id: !input clim_bureau
            data:
              temperature: "{{ states(!input temp_cible_nuit_bureau) | float }}"
          - service: climate.set_temperature
            target:
              entity_id: !input clim_chambre
            data:
              temperature: "{{ states(!input temp_cible_nuit_chambre) | float }}"
      - conditions:
          - condition: state
            entity_id: !input mode_nuit
            state: "off"
        sequence:
          - service: climate.set_temperature
            target:
              entity_id: !input clim_salon
            data:
              temperature: "{{ states(!input temp_cible_salon) | float }}"
          - service: climate.set_temperature
            target:
              entity_id: !input clim_bureau
            data:
              temperature: "{{ states(!input temp_cible_bureau) | float }}"
          - service: climate.set_temperature
            target:
              entity_id: !input clim_chambre
            data:
              temperature: "{{ states(!input temp_cible_chambre) | float }}"
mode: single
